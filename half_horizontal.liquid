<div class="view">
  <div class="layout grid">
    <div class="col--span-1 col gap--space-between py--1">
      <div class="item">
        <div class="meta"></div>
        <div class="content">
          <span class="value value--tnums">{{sum_pageviews | number_with_delimiter }}</span>
          <span class="label">Pageviews</span>
        </div>
      </div>
      <div class="border--h-5"></div>
      <div class="item">
        <div class="meta"></div>
        <div class="content">
          <span class="value value--tnums">{{sum_sessions | number_with_delimiter }}</span>
          <span class="label">Visitors</span>
        </div>
      </div>
    </div>

    <div id="{{ chart_id }}" class="col--span-3" style="width: 100%"></div>
  </div>

  <div class="title_bar">
    <img class="image" src="https://{{trmnl.plugin_settings.custom_fields_values.hostname}}/favicon-32x32.png" />
    <span class="title">Umami</span>
    <span class="instance">{{trmnl.plugin_settings.instance_name}}</span>
  </div>
</div>

<script type="text/javascript">
  var pageviews = [
    {% for item in pageviews %}
      ["{{item.x | slice: 0, 10}}", {{ item.y }}]{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ];

  var createChart = function() {
    new Chartkick["LineChart"](
    "{{ chart_id }}",
    pageviews,
    {
      adapter: "highcharts",
      prefix: "",
      thousands: ",",
      points: false,
      colors: ["black"],
      curve: true,
      library: {
        chart: {
          height: 180,
          space: [10, 0, 10, 0]
        },
        plotOptions: {
          series: {
            animation: false,
            lineWidth: 4
          }
        },
        yAxis: {
          labels: {
            style: {
              fontSize: "16px",
              color:"#000000"
            },
          },
          gridLineDashStyle: "shortdot",
          gridLineWidth: 1,
          gridLineColor: "#000000",
          tickAmount: 5
        },
        xAxis: {
          type: 'datetime', 
          labels: { 
            style: { fontSize: '16px', color: '#000000' },
            padding: 0,
            y: 10,
          }, 
          height: 155,
          type: "daytime",
          lineWidth: 0,
          gridLineDashStyle: "dot",
          tickWidth: 1,
          tickLength: 0,
          gridLineWidth: 1,
          gridLineColor: "#000000",
          tickPixelInterval: 120
        }
      }
    });
  };

  if ("Chartkick" in window) {
    createChart();
  } else {
    window.addEventListener("chartkick:load", createChart, true);
  }
</script>
